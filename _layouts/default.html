<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="icon" href="{{ site.baseurl }}/assets/images/logo.avif">

{% comment %} Enhanced SEO meta tags {% endcomment %}
{% include seo-meta.html %}

{% comment %} Structured data for search engines {% endcomment %}
{% include structured-data.html %}

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

<link href="{{ site.baseurl }}/assets/css/screen.css" rel="stylesheet">

<link href="{{ site.baseurl }}/assets/css/main.css" rel="stylesheet">

{% if page.layout == "projects" %}
<link href="{{ site.baseurl }}/assets/css/projects.css" rel="stylesheet">
{% endif %}

<script src="{{ site.baseurl }}/assets/js/jquery.min.js"></script>

<!-- Dark Mode Initialization -->
<script>
    // Check for saved theme preference or default to system preference
    const savedTheme = localStorage.getItem('theme');
    const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    
    if (savedTheme) {
        document.documentElement.setAttribute('data-theme', savedTheme);
    } else if (systemPrefersDark) {
        document.documentElement.setAttribute('data-theme', 'dark');
    }
</script>

</head>

{% if jekyll.environment == 'production' %}
<!-- Google Analytics GA4 -->
<script async src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', '{{ site.google_analytics }}');
</script>
{% endif %}

{% capture layout %}{% if page.layout %}layout-{{ page.layout }}{% endif %}{% endcapture %}
<body class="{{layout}}">
    <!-- Skip Links for Accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <a href="#navbarMediumish" class="skip-link">Skip to navigation</a>
	<!-- defer loading of font and font awesome -->
	<noscript id="deferred-styles">
		<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	</noscript>


<!-- Begin Menu Navigation
================================================== -->
<nav class="navbar navbar-expand-lg navbar-light fixed-top mediumnavigation nav-down" aria-label="Main navigation">

    <div class="container pr-0">

    <!-- Mobile Dark Mode Toggle (Left side on mobile) -->
    <div class="mobile-theme-switch d-lg-none">
        <label class="theme-switch" for="mobileThemeToggle">
            <input type="checkbox" id="mobileThemeToggle" aria-label="Toggle dark mode" />
            <div class="slider" role="button">
                <i class="fas fa-sun"></i>
                <i class="fas fa-moon"></i>
            </div>
        </label>
    </div>

    <!-- Begin Logo -->
    <a class="navbar-brand" href="{{ site.baseurl }}/">
    <img class="navbar-logo" src="{{ site.baseurl }}/{{ site.logo }}" alt="{{ site.name }}" width="50px" height="">
    </a>
    <!-- End Logo -->

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarMediumish">

        <!-- Begin Menu -->

            <ul class="navbar-nav ml-auto">

                {% for item in site.data.nav_pages.pages %}
                <li class="nav-item {% if item.url == page.url %}active{% endif %}">
                    <a class="nav-link" href="{{ item.url }}">{{ item.title }}</a>
                </li>
                {% endfor %}

                <li class="nav-item">
                    {% include search.html %}
                </li>

                <!-- Dark Mode Toggle Switch (Desktop only) -->
                <li class="nav-item d-none d-lg-flex align-items-center">
                    <div class="theme-switch-wrapper">
                        <label class="theme-switch" for="darkModeToggle">
                            <input type="checkbox" id="darkModeToggle" aria-label="Toggle dark mode" />
                            <div class="slider" role="button">
                                <i class="fas fa-sun"></i>
                                <i class="fas fa-moon"></i>
                            </div>
                        </label>
                    </div>
                </li>

            </ul>

        <!-- End Menu -->

    </div>

    </div>
</nav>
<!-- End Navigation
================================================== -->

<div class="site-content">

<div class="container">

<!-- Content
================================================== -->
<div class="main-content" id="main-content">
    {{ content }}
</div>

{% if site.mailchimp-list %}
<!-- Bottom Alert Bar
================================================== -->
<aside class="alertbar" aria-label="Newsletter subscription">
	<div class="container text-center">
		<span class="newsletter-heading"><img src="{{ site.baseurl }}/{{ site.logo }}" alt="{{site.title}}"> &nbsp; Never miss a <b>story</b> from us, subscribe to our newsletter</span>
        <form action="{{site.mailchimp-list}}" method="post" name="mc-embedded-subscribe-form" class="wj-contact-form validate" target="_blank" novalidate>
            <div class="mc-field-group">
            <input type="email" placeholder="Email" name="EMAIL" class="required email newsletter-input" id="mce-EMAIL" autocomplete="on" required aria-label="Email address for newsletter">
            <input type="submit" value="Subscribe" name="subscribe" class="heart">
            </div>
        </form>
	</div>
</aside>
{% endif %}

</div>

<!-- Begin Footer
================================================== -->
<footer class="footer">
    <div class="container">
        <div class="row mb-4">
            <div class="col-md-12 text-center">
                <div class="contact-section">
                    <h5 class="contact-title">Let's Work Together</h5>
                    <p class="contact-subtitle">Need help scaling your backend systems? I can help you build robust, high-performance solutions.</p>
                    <div class="contact-links">
                        <a href="mailto:{{ site.authors.prateek.email }}" class="contact-link email-link">
                            <i class="fas fa-envelope"></i> Get in touch
                        </a>
                        <span class="contact-divider">•</span>
                        <a href="{{ site.authors.prateek.twitter }}" class="contact-link" target="_blank" aria-label="Follow me on Twitter (opens in new tab)">
                            <i class="fab fa-twitter"></i> Twitter
                        </a>
                        <span class="contact-divider">•</span>
                        <a href="{{ site.authors.prateek.linkedin }}" class="contact-link" target="_blank" aria-label="Connect with me on LinkedIn (opens in new tab)">
                            <i class="fab fa-linkedin"></i> LinkedIn
                        </a>
                        <span class="contact-divider">•</span>
                        <a href="{{ site.authors.prateek.github }}" class="contact-link" target="_blank" aria-label="View my projects on GitHub (opens in new tab)">
                            <i class="fab fa-github"></i> GitHub
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <hr class="footer-divider">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                Copyright © {{ site.time | date: "%Y" }} {{ site.name }}
            </div>
            <div class="col-md-6 col-sm-6 text-center text-lg-right">
                Built with Jekyll
            </div>
        </div>
    </div>
</footer>
<!-- End Footer
================================================== -->

</div> <!-- /.site-content -->

<!-- Scripts
================================================== -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

<script src="{{ site.baseurl }}/assets/js/mediumish.js"></script>

{% if site.lazyimages == "enabled" %}
<script src="{{ site.baseurl }}/assets/js/lazyload.js"></script>
{% endif %}

<script src="{{ site.baseurl }}/assets/js/ie10-viewport-bug-workaround.js"></script>

{% include newsletter-popup.html %}

<script>
function copyToClipboard(text) {
    // Create a temporary input element
    var tempInput = document.createElement("input");
    tempInput.value = text;
    document.body.appendChild(tempInput);
    tempInput.select();
    document.execCommand("copy");
    document.body.removeChild(tempInput);
    
    // Show feedback to user
    var copyButton = event.target.closest('a');
    var icon = copyButton.querySelector('i');
    var originalTitle = copyButton.title;
    
    // Store original classes
    var originalClasses = icon.className;
    
    // Change to checkmark with green color
    icon.className = 'fa-solid fa-check';
    icon.style.color = '#28a745';
    copyButton.title = "Copied!";
    
    // Reset after 2 seconds
    setTimeout(function() {
        icon.className = originalClasses;
        icon.style.color = '';
        copyButton.title = originalTitle;
    }, 2000);
}

// Prevent share section from overlapping newsletter
document.addEventListener('DOMContentLoaded', function() {
    var shareElement = document.querySelector('.share');
    var alertBar = document.querySelector('.alertbar');
    
    if (shareElement && alertBar) {
        function checkOverlap() {
            var shareRect = shareElement.getBoundingClientRect();
            var alertRect = alertBar.getBoundingClientRect();
            
            // If share section would overlap with alertbar, unstick it
            if (shareRect.bottom > alertRect.top - 20) {
                shareElement.style.position = 'absolute';
                shareElement.style.bottom = '0';
                shareElement.style.top = 'auto';
            } else {
                shareElement.style.position = '';
                shareElement.style.bottom = '';
                shareElement.style.top = '';
            }
        }
        
        window.addEventListener('scroll', checkOverlap);
        window.addEventListener('resize', checkOverlap);
    }
});

// Dark Mode Toggle Functionality
document.addEventListener('DOMContentLoaded', function() {
    const darkModeToggle = document.getElementById('darkModeToggle');
    const mobileDarkModeToggle = document.getElementById('mobileThemeToggle');
    const html = document.documentElement;
    
    // Initialize toggles based on current theme
    const currentTheme = html.getAttribute('data-theme');
    if (darkModeToggle) darkModeToggle.checked = currentTheme === 'dark';
    if (mobileDarkModeToggle) mobileDarkModeToggle.checked = currentTheme === 'dark';
    
    // Handle theme change
    function handleThemeChange(isDark) {
        const newTheme = isDark ? 'dark' : 'light';
        
        html.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
        
        // Sync both toggles
        if (darkModeToggle) darkModeToggle.checked = isDark;
        if (mobileDarkModeToggle) mobileDarkModeToggle.checked = isDark;
        
        // Update Giscus if present
        if (typeof updateGiscusTheme === 'function') {
            updateGiscusTheme();
        }
    }
    
    // Desktop toggle handler
    if (darkModeToggle) {
        darkModeToggle.addEventListener('change', function() {
            handleThemeChange(this.checked);
        });
    }
    
    // Mobile toggle handler
    if (mobileDarkModeToggle) {
        mobileDarkModeToggle.addEventListener('change', function() {
            handleThemeChange(this.checked);
        });
    }
    
    // Listen for system theme changes
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
        // Only update if user hasn't manually set a preference
        if (!localStorage.getItem('theme')) {
            const newTheme = e.matches ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            if (darkModeToggle) darkModeToggle.checked = e.matches;
            if (mobileDarkModeToggle) mobileDarkModeToggle.checked = e.matches;
        }
    });
    
    // Close mobile menu on scroll
    window.addEventListener('scroll', function() {
        const mobileMenu = document.getElementById('navbarMediumish');
        const navbarToggler = document.querySelector('.navbar-toggler');
        
        if (mobileMenu && mobileMenu.classList.contains('show')) {
            // Collapse the menu
            mobileMenu.classList.remove('show');
            navbarToggler.setAttribute('aria-expanded', 'false');
        }
    });
});

// Subscribe Popup Function
function openSubscribePopup() {
    // Track floating button click in Google Analytics
    if (typeof gtag !== 'undefined') {
        gtag('event', 'subscribe_email_entered');
    }
    
    // Get Substack URL from configuration
    var substackUrl = 'https://prateekkish.substack.com/subscribe';
    
    // Calculate popup window dimensions and position
    var width = 550;
    var height = 650;
    var left = (window.screen.width - width) / 2;
    var top = (window.screen.height - height) / 2;
    
    // Popup window features
    var features = 'width=' + width + 
                   ',height=' + height + 
                   ',left=' + left + 
                   ',top=' + top + 
                   ',resizable=yes,scrollbars=yes,status=yes';
    
    // Open the popup window
    window.open(substackUrl, 'substackPopup', features);
    
    return false;
}


// Hide/show floating subscribe button based on newsletter visibility
document.addEventListener('DOMContentLoaded', function() {
    var floatingBtn = document.querySelector('.floating-subscribe-btn');
    var newsletterSection = document.getElementById('newsletter-section');
    
    if (floatingBtn && newsletterSection) {
        function checkNewsletterVisibility() {
            var rect = newsletterSection.getBoundingClientRect();
            var windowHeight = window.innerHeight || document.documentElement.clientHeight;
            
            // Check if newsletter section is in viewport
            var isVisible = rect.top < windowHeight && rect.bottom > 0;
            
            if (isVisible) {
                floatingBtn.classList.add('hide');
            } else {
                floatingBtn.classList.remove('hide');
            }
        }
        
        // Check on scroll and resize
        window.addEventListener('scroll', checkNewsletterVisibility);
        window.addEventListener('resize', checkNewsletterVisibility);
        
        // Initial check
        setTimeout(checkNewsletterVisibility, 1500); // After animation completes
    }
});
</script>

</body>
</html>
